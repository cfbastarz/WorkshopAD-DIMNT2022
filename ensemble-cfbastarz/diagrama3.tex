\documentclass[tikz]{standalone}

\usetikzlibrary{calc,positioning}

% Create fake \onslide and other commands for standalone picture
\usepackage{xparse}
\NewDocumentCommand{\onslide}{s t+ d<>}{}
\NewDocumentCommand{\only}{d<>}{}
\NewDocumentCommand{\uncover}{d<>}{}
\NewDocumentCommand{\visible}{d<>}{}
\NewDocumentCommand{\invisible}{d<>}{}


% Carregamento dos pacotes utilizados
\usepackage[brazilian]{babel} % comentar este pacote se a apresentação for em inglês
\usepackage{times}

%\usepackage[utf8]{inputenc}
\usepackage{fontspec}

\usepackage{graphicx}
\usepackage{subfigure}

\usepackage{tabularx}
\usepackage{booktabs}

% Carregamento dos pacotes utilizados
\usepackage[brazilian]{babel} % comentar este pacote se a apresentação for em inglês
\usepackage{times}

%\usepackage[utf8]{inputenc}
\usepackage{fontspec}

\usepackage{pgf,tikz}
\usetikzlibrary{shapes.geometric, arrows}
\usetikzlibrary{positioning,fit,calc}
\usetikzlibrary{patterns}
\usetikzlibrary{overlay-beamer-styles}



\usepackage{varwidth}
\usepackage{ragged2e}

\usepackage{xcolor}
\usepackage{xcolor-material}
\usepackage{xcolor-solarized}

\usepackage{graphicx}
%\usepackage{subfigure}

\usepackage{subcaption}

\usepackage{listings}

\usepackage[most]{tcolorbox}
\usepackage[cache=false]{minted}
\usemintedstyle{material}
\tcbuselibrary{breakable}

\tcbuselibrary{minted}

\usetikzlibrary{decorations.pathmorphing} 
\tcbuselibrary{skins}

\usepackage{tabularx}
\usepackage{booktabs}


\tikzstyle{process1} = [rectangle, rounded corners, minimum width=3cm, minimum height=1cm, text centered, draw=black, fill=MaterialBlue!30]

\tikzstyle{process2} = [rectangle, rounded corners, minimum width=3cm, minimum height=1cm, text centered, draw=black, fill=MaterialYellow!30]

\tikzstyle{process3} = [rectangle, rounded corners, minimum width=3cm, minimum height=1cm, text centered, draw=black, fill=MaterialGrey!30]

\tikzstyle{process4} = [rectangle, rounded corners, minimum width=3cm, minimum height=1cm, text centered, draw=black, fill=MaterialOrange!30]

\tikzstyle{process5} = [rectangle, rounded corners, minimum width=3cm, minimum height=1cm, text centered, draw=black, fill=MaterialGreen!30]

\tikzstyle{process6} = [rectangle, rounded corners, minimum width=3cm, minimum height=1cm, text centered, draw=black, fill=MaterialRed!30]

\tikzstyle{process7} = [rectangle, rounded corners, minimum width=3cm, minimum height=1cm, text centered, draw=black, fill=MaterialPurple!30]

\tikzstyle{process8} = [rectangle, rounded corners, minimum width=3cm, minimum height=1cm, text centered, draw=black, fill=MaterialCyan!30]

\tikzstyle{arrow} = [thick,->,>=stealth]        	


\begin{document}


\begin{tikzpicture}[node distance=2.25cm, thick,scale=1, every node/.style={scale=0.5}]

% Formas (col1)
\node (anl_ctr_ncep) [process1, visible on=<1->]                        
	{\begin{varwidth}{3cm}\Centering Condição Inicial\\Controle\\(NCEP) \end{varwidth}};
\node (anl_rdp_num1) [process2, below of=anl_ctr_ncep, visible on=<2->] 
	{\begin{varwidth}{3cm}\Centering Condição Inicial\\Pert. Rand. \#1 \end{varwidth}};
\node (anl_rdp_num2) [process3, below of=anl_rdp_num1, visible on=<2->] 
	{\begin{varwidth}{3cm}\Centering Condição Inicial\\Pert. Rand. \#2 \end{varwidth}};
\node (anl_rdp_dots) [process4, below of=anl_rdp_num2, visible on=<2->] 
	{\begin{varwidth}{3cm}\Centering \cdots \end{varwidth}};
\node (anl_rdp_numn) [process5, below of=anl_rdp_dots, visible on=<2->] 
	{\begin{varwidth}{3cm}\Centering Condição Inicial\\Pert. Rand. \#$n$ \end{varwidth}};

% Formas (col2)
\node (fct_ctr_ncep) [process1, xshift=4.75cm, visible on=<3->]            
	{\begin{varwidth}{3cm}\Centering Previsões\\Controle\\(48h, 3/3h) \end{varwidth}};
\node (fct_rdp_num1) [process2, below of=fct_ctr_ncep, visible on=<4->] 
	{\begin{varwidth}{3cm}\Centering Previsões Pert.\\Rand. \#1\\(48h, 3/3h) \end{varwidth}};
\node (fct_rdp_num2) [process3, below of=fct_rdp_num1, visible on=<4->] 
	{\begin{varwidth}{3cm}\Centering Previsões Pert.\\Rand. \#2\\(48h, 3/3h) \end{varwidth}};
\node (fct_rdp_dots) [process4, below of=fct_rdp_num2, visible on=<4->] 
	{\begin{varwidth}{3cm}\Centering \cdots \end{varwidth}};
\node (fct_rdp_numn) [process5, below of=fct_rdp_dots, visible on=<4->] 
	{\begin{varwidth}{3cm}\Centering Previsões Pert.\\Rand. \#$n$\\(48h, 3/3h) \end{varwidth}};

% Formas (col3)
\node (pert_eof1) [process2, xshift=9.5cm, yshift=-1.15cm, visible on=<6->] 
	{\begin{varwidth}{3cm}\Centering Perturbações EOF \#1 \end{varwidth}};
\node (pert_eof_dots) [process4, below of=pert_eof1, yshift=-1.15cm, visible on=<7->]    
	{\begin{varwidth}{3cm}\Centering \cdots \end{varwidth}};
\node (pert_eofn) [process5, below of=pert_eof_dots, yshift=-1.15cm, visible on=<8->]    
	{\begin{varwidth}{3cm}\Centering Perturbações EOF \#$n$ \end{varwidth}};

% Formas (col4)
\node (anl_ctr_ncep2) [process1, xshift=14cm, yshift=2.095cm, visible on=<11->] 
	{\begin{varwidth}{3cm}\Centering Condição Inicial\\Controle\\(NCEP) \#1 \end{varwidth}};

\node (pert_eof1_som) [process2, below of=anl_ctr_ncep2, visible on=<9->]     
	{\begin{varwidth}{3cm}\Centering Condição Inicial\\EOF \#1\\(Somada) \end{varwidth}};
\node (pert_eof1_sub) [process2, below of=pert_eof1_som, yshift=0.25cm, visible on=<9->]      
	{\begin{varwidth}{3cm}\Centering Condição Inicial\\EOF \#1\\(Subtraída) \end{varwidth}};
	
\node (pert_eof2_som) [process4, below of=pert_eof1_sub, yshift=0.9cm, visible on=<10->]      
	{\begin{varwidth}{3cm}\Centering \cdots \end{varwidth}};
\node (pert_eof2_sub) [process4, below of=pert_eof2_som, yshift=0.15cm, visible on=<10->]      
	{\begin{varwidth}{3cm}\Centering \cdots \end{varwidth}};
	
\node (pert_eofn_som) [process5, below of=pert_eof2_sub, yshift=0.9cm, visible on=<11->]      
	{\begin{varwidth}{3cm}\Centering Condição Inicial\\EOF \#$n$\\(Somada) \end{varwidth}};
\node (pert_eofn_sub) [process5, below of=pert_eofn_som, yshift=0.25cm, visible on=<11->]      
	{\begin{varwidth}{3cm}\Centering Condição Inicial\\EOF \#$n$\\(Subtraída) \end{varwidth}};

% Formas (col5)
\node (fct_ctr_ncep2) [process1, xshift=18.5cm, yshift=2.095cm, visible on=<13->] 
	{\begin{varwidth}{3cm}\Centering Previsão\\Membro \#1\\(360h, 6/6h) \#1 \end{varwidth}};
	
\node (fct_eof1_som) [process2, below of=fct_ctr_ncep2, visible on=<13->]       
	{\begin{varwidth}{3cm}\Centering Previsão\\Membro \#2\\(360h, 6/6h) \end{varwidth}};
\node (fct_eof1_sub) [process2, below of=fct_eof1_som, yshift=0.25cm, visible on=<13->]        
	{\begin{varwidth}{3cm}\Centering Previsão Membro \#3\\(360h, 6/6h) \end{varwidth}};
	
\node (fct_eof2_som) [process4, below of=fct_eof1_sub, yshift=0.9cm, visible on=<13->]        
	{\begin{varwidth}{3cm}\Centering \cdots \end{varwidth}};
\node (fct_eof2_sub) [process4, below of=fct_eof2_som, yshift=0.15cm, visible on=<13->]        
	{\begin{varwidth}{3cm}\Centering \cdots \end{varwidth}};
	
\node (fct_eofn_som) [process5, below of=fct_eof2_sub, yshift=0.9cm, visible on=<13->]        
	{\begin{varwidth}{3cm}\Centering Previsão\\Membro \#$n-1$\\(360h, 6/6h) \end{varwidth}};
\node (fct_eofn_sub) [process5, below of=fct_eofn_som, yshift=0.25cm, visible on=<13->]     
	{\begin{varwidth}{3cm}\Centering Previsão\\Membro \#$n$\\(360h, 6/6h) \end{varwidth}};

% Flechas (col1)
\draw [arrow, visible on=<2->] (anl_ctr_ncep) -- node[anchor=west] {(RAND)} (anl_rdp_num1);
\draw [arrow, dashed, visible on=<2->] (anl_rdp_num1) -- node[anchor=west] {(RAND)} (anl_rdp_num2);
\draw [arrow, dashed, visible on=<2->] (anl_rdp_num2) -- node[anchor=west] {(RAND)} (anl_rdp_dots);
\draw [arrow, dashed, visible on=<2->] (anl_rdp_dots) -- node[anchor=west] {(RAND)} (anl_rdp_numn);

% Flechas (col2)
\draw [stealth-stealth, visible on=<5->] (fct_ctr_ncep) -- node[anchor=west] {(EOF)} (fct_rdp_num1);
\draw [arrow, dashed, visible on=<5->] (fct_rdp_num1) -- node[anchor=west] {(EOF)} (fct_rdp_num2);
\draw [arrow, dashed, visible on=<5->] (fct_rdp_num2) -- node[anchor=west] {(EOF)} (fct_rdp_dots);
\draw [arrow, dashed, visible on=<5->] (fct_rdp_dots) -- node[anchor=west] {(EOF)} (fct_rdp_numn);

% Flechas (col1->col2)
\draw [arrow, visible on=<3->] (anl_ctr_ncep) -- (fct_ctr_ncep);
\draw [arrow, visible on=<4->] (anl_rdp_num1) -- (fct_rdp_num1);
\draw [arrow, visible on=<4->] (anl_rdp_num2) -- (fct_rdp_num2);
\draw [arrow, visible on=<4->] (anl_rdp_dots) -- (fct_rdp_dots);
\draw [arrow, visible on=<4->] (anl_rdp_numn) -- (fct_rdp_numn);

% Linhas e flechas entre col2 e col3
\node [coordinate, right = 0.4375cm of fct_ctr_ncep] (ADL1){};
\draw [arrow, visible on=<6->] (fct_ctr_ncep) -- (ADL1) |- (pert_eof1);

\node [coordinate, right = 0.4375cm of fct_rdp_num1] (ADL2){};
\draw [arrow, visible on=<6->] (fct_rdp_num1) -- (ADL2) |- (pert_eof1);

\node [coordinate, right = 0.4375cm of fct_ctr_ncep] (ADL3){};
\draw [arrow, visible on=<7->] (fct_ctr_ncep) -- (ADL3) |- (pert_eof_dots);

\node [coordinate, right = 0.4375cm of fct_rdp_dots] (ADL4){};
\draw [arrow, visible on=<7->] (fct_rdp_dots) -- (ADL4) |- (pert_eof_dots);

\node [coordinate, right = 0.4375cm of fct_ctr_ncep] (ADL5){};
\draw [arrow, visible on=<8->] (fct_ctr_ncep) -- (ADL5) |- (pert_eofn);

\node [coordinate, right = 0.4375cm of fct_rdp_numn] (ADL6){};
\draw [arrow, visible on=<8->] (fct_rdp_numn) -- (ADL6) |- (pert_eofn);

% Linhas e flechas entre col3 e col4 e entre as colunas col4 e col5
\node [coordinate, right = 0.4375cm of pert_eof1] (BDL1){};
\draw [arrow, visible on=<9->] (pert_eof1) -- (BDL1) |- (pert_eof1_som);

\node [coordinate, right = 0.4375cm of pert_eof1] (BDL2){};
\draw [arrow, visible on=<9->] (pert_eof1) -- (BDL2) |- (pert_eof1_sub);

\node [coordinate, right = 0.4375cm of pert_eof_dots] (BDL3){};
\draw [arrow, visible on=<10->] (pert_eof_dots) -- (BDL3) |- (pert_eof2_som);

\node [coordinate, right = 0.4375cm of pert_eof_dots] (BDL4){};
\draw [arrow, visible on=<10->] (pert_eof_dots) -- (BDL4) |- (pert_eof2_sub);

\node [coordinate, right = 0.4375cm of pert_eofn] (BDL5){};
\draw [arrow, visible on=<11->] (pert_eofn) -- (BDL5) |- (pert_eofn_som);

\node [coordinate, right = 0.4375cm of pert_eofn] (BDL6){};
\draw [arrow, visible on=<11->] (pert_eofn) -- (BDL6) |- (pert_eofn_sub);

% Flechas (col4->col5)
\draw [arrow, visible on=<13->] (anl_ctr_ncep2) -- (fct_ctr_ncep2);
\draw [arrow, visible on=<13->] (pert_eof1_som) -- (fct_eof1_som);
\draw [arrow, visible on=<13->] (pert_eof1_sub) -- (fct_eof1_sub);
\draw [arrow, visible on=<13->] (pert_eof2_som) -- (fct_eof2_som);
\draw [arrow, visible on=<13->] (pert_eof2_sub) -- (fct_eof2_sub);
\draw [arrow, visible on=<13->] (pert_eofn_som) -- (fct_eofn_som);
\draw [arrow, visible on=<13->] (pert_eofn_sub) -- (fct_eofn_sub);

% Linhas e flechas entre col1 e col4
\node [coordinate, above = 0.655cm of anl_ctr_ncep] (EDL1){};
\draw [path, visible on=<11->] (anl_ctr_ncep) |- (anl_ctr_ncep2);

% Retângulos das colunas 4 e 5
%\draw[pattern=north west lines, pattern color=blue, thick, dotted] ($(anl_ctr_ncep2.north west)+(-0.5,0.25)$)  rectangle ($(pert_eofn_sub.south east)+(0.3,-1)$);
\draw[thick, dotted, visible on=<12->] ($(anl_ctr_ncep2.north west)+(-0.5,0.25)$)  rectangle ($(pert_eofn_sub.south east)+(0.3,-1)$);
\node (r1Label)[below=0.15cm of pert_eofn_sub, visible on=<12->] {\begin{varwidth}{3cm}\Centering \textit{Ensemble} final\\de Análises\\Tamanho: $2n+1$ \end{varwidth}};

\draw[thick, dotted, visible on=<14->] ($(fct_ctr_ncep2.north west)+(-0.5,0.25)$)  rectangle ($(fct_eofn_sub.south east)+(0.3,-1)$);
\node (r1Label)[below=0.15cm of fct_eofn_sub, visible on=<14->] {\begin{varwidth}{3cm}\Centering \textit{Ensemble} final\\de Previsões\\Tamanho: $2n+1$ \end{varwidth}};

\end{tikzpicture}

\end{document}